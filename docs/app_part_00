const { useState, useEffect } = React;

// Icon Components (using Font Awesome classes instead of Lucide)
const Icon = ({ name, className = "w-5 h-5" }) => (
  React.createElement('i', { 
    className: name + ' ' + className,
    'aria-hidden': 'true' 
  })
);

const App = () => {
  const [currentView, setCurrentView] = useState('family-home');
  const [selectedChild, setSelectedChild] = useState(null);
  const [selectedClass, setSelectedClass] = useState(null);
  const [editingClass, setEditingClass] = useState(null);
  const [isEditingClass, setIsEditingClass] = useState(false);
  const [availability, setAvailability] = useState({});
  const [classForm, setClassForm] = useState({
    name: '',
    addresses: [{ name: '', address: '' }],
    sessions: [{ day: '', startTime: '', endTime: '', addressIndex: 0 }],
    coachName: '',
    coachPhone: '',
    managerName: '',
    managerPhone: '',
    managerEmail: ''
  });
  const [chatMessages, setChatMessages] = useState([
    {
      id: 1,
      type: 'bot',
      message: '×©×œ×•×! ×× ×™ ×›××Ÿ ×œ×¢×–×•×¨ ×œ×š ×œ× ×”×œ ×©×™× ×•×™×™× ×‘×—×•×’×™×. ×ª×•×›×œ ×œ×”×“×‘×™×§ ×”×•×“×¢×•×ª ××”×•×•××˜×¡××¤ ××• ×œ×›×ª×•×‘ ×©×™× ×•×™×™× ×™×©×™×¨×•×ª.',
      timestamp: new Date().toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' })
    }
  ]);
  const [chatInput, setChatInput] = useState('');
  const [isChatOpen, setIsChatOpen] = useState(false);
  const [isProcessing, setIsProcessing] = useState(false);
  const [pendingScheduleChange, setPendingScheduleChange] = useState(null);
  const [availabilityStatus, setAvailabilityStatus] = useState({
    '××©×¤×—×ª ×›×”×Ÿ': false,
    '××©×¤×—×ª ×œ×•×™': false, 
    '××©×¤×—×ª ××‘×¨×”×': false,
    '××©×¤×—×ª ×“×•×“': true,
    '××©×¤×—×ª ×©×œ×•×': false,
    '××©×¤×—×ª ×—×Ÿ': false
  });
  const [userGuideSection, setUserGuideSection] = useState('overview');
  const [isClassManager, setIsClassManager] = useState(true);
  const [isAdminMode, setIsAdminMode] = useState(false);
  const [adminPassword, setAdminPassword] = useState('');
  const [showAdminLogin, setShowAdminLogin] = useState(false);
  const [waitingRoomFilters, setWaitingRoomFilters] = useState({
    city: '',
    classType: '',
    searchText: '',
    showFullGroups: false
  });
  const [childForm, setChildForm] = useState({
    name: '',
    birthDate: '',
    phone: '',
    address: ''
  });
  const [weeklyAvailability, setWeeklyAvailability] = useState({
    '×¨××©×•×Ÿ': { morning: false, afternoon: false, evening: false },
    '×©× ×™': { morning: false, afternoon: false, evening: false },
    '×©×œ×™×©×™': { morning: false, afternoon: false, evening: false },
    '×¨×‘×™×¢×™': { morning: false, afternoon: false, evening: false },
    '×—××™×©×™': { morning: false, afternoon: false, evening: false },
    '×©×™×©×™': { morning: false, afternoon: false, evening: false },
    '×©×‘×ª': { morning: false, afternoon: false, evening: false }
  });
  // × ×ª×•× ×™ ××¢×¨×›×ª ××“×•××™× ×œ×× ×”×œ
  const [systemStats, setSystemStats] = useState({
    totalFamilies: 24,
    totalChildren: 48,
    totalClasses: 12,
    activeTransportGroups: 8,
    pendingRequests: 5,
    emergencyAlerts: 2
  });
  
  const [allFamilies, setAllFamilies] = useState([
    {
      id: 1,
      name: '××©×¤×—×ª ×›×”×Ÿ',
      children: 2,
      activeClasses: 3,
      phone: '050-123-4567',
      email: 'cohen@email.com',
      lastActive: '2025-08-16',
      availabilityStatus: '×××œ× ×–××™× ×•×ª'
    },
    {
      id: 2,
      name: '××©×¤×—×ª ×œ×•×™',
      children: 1,
      activeClasses: 2,
      phone: '052-987-6543',
      email: 'levi@email.com',
      lastActive: '2025-08-15',
      availabilityStatus: '××™×œ× ×–××™× ×•×ª'
    },
    {
      id: 3,
      name: '××©×¤×—×ª ××‘×¨×”×',
      children: 3,
      activeClasses: 4,
      phone: '054-111-2222',
      email: 'avraham@email.com',
      lastActive: '2025-08-14',
      availabilityStatus: '×œ× ××™×œ× ×–××™× ×•×ª'
    },
    {
      id: 4,
      name: '××©×¤×—×ª ×“×•×“',
      children: 2,
      activeClasses: 2,
      phone: '053-333-4444',
      email: 'david@email.com',
      lastActive: '2025-08-16',
      availabilityStatus: '××™×œ× ×–××™× ×•×ª'
    }
  ]);
  
  const [availableClasses, setAvailableClasses] = useState([
    {
      id: 'CLS001',
      name: '×›×“×•×¨×¡×œ',
      city: '×ª×œ ××‘×™×‘',
      location: '×‘×™×ª ×¡×¤×¨ ××™×œ×•×Ÿ',
      address: '×¨×—×³ ×”×¨×¦×œ 45, ×ª×œ ××‘×™×‘',
      coach: '×“×•×“ ×›×”×Ÿ',
      coachPhone: '052-987-6543',
      schedule: '×¨××©×•×Ÿ, ×©×œ×™×©×™, ×—××™×©×™ 16:00-17:30',
      ageGroup: '10-12',
      currentMembers: 5,
      maxMembers: 8,
      manager: '××©×¤×—×ª ×œ×•×™',
      managerPhone: '050-111-2222',
      description: '×—×•×’ ×›×“×•×¨×¡×œ ×œ××ª×—×™×œ×™×, ××•×•×™×¨×” ×˜×•×‘×” ×•×—×‘×¨×•×ª×™×ª'
    },
    {
      id: 'CLS002', 
      name: '×©×—×™×™×”',
      city: '×ª×œ ××‘×™×‘',
      location: '×‘×¨×™×›×ª ×”×¢×™×¨',
      address: '×¨×—×³ ×‘×™××œ×™×§ 12, ×ª×œ ××‘×™×‘',
      coach: '××™×¨×™ ×œ×•×™',
      coachPhone: '054-123-4567',
      schedule: '×©× ×™, ×¨×‘×™×¢×™ 17:00-18:00',
      ageGroup: '8-14',
      currentMembers: 3,
      maxMembers: 6,
      manager: '××©×¤×—×ª ×’×¨×™×Ÿ',
      managerPhone: '050-333-4444',
      description: '×œ×™××•×“ ×©×—×™×™×” ×‘×¦×•×¨×” ××§×¦×•×¢×™×ª ×•×‘×˜×•×—×”'
    }
  ]);
  const [notifications, setNotifications] = useState([
    { id: 1, text: '×ª×–×›×•×¨×ª: ××œ× ×–××™× ×•×ª ×œ×—×•×’ ×›×“×•×¨×¡×œ ×¢×“ ××—×¨ ×‘×¢×¨×‘', type: 'warning', time: '14:30' },
    { id: 2, text: '×©×™×‘×•×¥ ×—×“×© ×¤×•×¨×¡× ×œ×—×•×’ ×©×—×™×™×”', type: 'info', time: '09:15' }
  ]);

  // × ×ª×•× ×™ ×”××©×¤×—×” ×•×”×™×œ×“×™× ×¢× ×”×—×•×’×™× ×©×œ×”×
  const familyData = {
    familyName: '××©×¤×—×ª ×›×”×Ÿ',
    parents: {
      parent1: { name: '×™×•×¡×™', phone: '050-123-4567', email: 'yossi@gmail.com' },
      parent2: { name: '×¨×—×œ', phone: '052-987-6543', email: 'rachel@gmail.com' }
    },
    children: [
      {
        id: 1,
        name: '×“× ×™ ×›×”×Ÿ',
        birthDate: '2012-08-15',
        phone: '050-111-2222',
        address: '×¨×—×³ ×”×¨×¦×œ 123, ×ª×œ ××‘×™×‘',
        classes: [
          {
            id: 1,
            name: '×›×“×•×¨×¡×œ',
            location: '×‘×™×ª ×¡×¤×¨ ×¨××ª ××‘×™×‘',
            address: '×¨×—×³ ×”×¨×¦×œ 45, ×ª×œ ××‘×™×‘',
            schedule: '×¨××©×•×Ÿ, ×©×œ×™×©×™, ×—××™×©×™ 16:00-17:30',
            coach: '×“×•×“ ×›×”×Ÿ - 052-987-6543',
            families: [
              { name: '××©×¤×—×ª ×›×”×Ÿ', rides: 12, children: ['×“× ×™'], parents: { parent1: '×™×•×¡×™', parent2: '×¨×—×œ' } },
              { name: '××©×¤×—×ª ×œ×•×™', rides: 8, children: ['×™×•×‘×œ'], parents: { parent1: '×“×•×“', parent2: '××™×¨×™' } }
            ],
            weeklySchedule: [
              { day: '×¨××©×•×Ÿ', pickup: '××©×¤×—×ª ×›×”×Ÿ', return: '××©×¤×—×ª ×œ×•×™', time: '16:00-17:30' },
              { day: '×©×œ×™×©×™', pickup: '××©×¤×—×ª ××‘×¨×”×', return: '××©×¤×—×ª ×“×•×“', time: '16:00-17:30' }
            ],
            myTasks: [
              { date: '×™×•× ×¨××©×•×Ÿ 15/8', task: '××™×¡×•×£ ××”×—×•×’', time: '17:30', children: ['×“× ×™', '×™×•×‘×œ', '× ×•×¢×”'] }
            ]
          }
        ]
      }
    ]
  };

  const days = ['×¨××©×•×Ÿ', '×©× ×™', '×©×œ×™×©×™', '×¨×‘×™×¢×™', '×—××™×©×™', '×©×™×©×™', '×©×‘×ª'];

  // ×¤×•× ×§×¦×™×” ×œ×—×™×©×•×‘ ×’×™×œ
  const calculateAge = (birthDate) => {
    if (!birthDate) return null;
    const today = new Date();
    const birth = new Date(birthDate);
    let age = today.getFullYear() - birth.getFullYear();
    const monthDiff = today.getMonth() - birth.getMonth();
    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
      age--;
    }
    return age;
  };

  // ×¤×•× ×§×¦×™×” ×œ×‘×“×™×§×ª ×™×•× ×”×•×œ×“×ª ×”×™×•×
  const getTodaysBirthdays = () => {
    const today = new Date();
    const todayMonth = today.getMonth() + 1;
    const todayDate = today.getDate();
    
    const birthdays = [];
    
    familyData.children.forEach(child => {
      if (child.birthDate) {
        const birth = new Date(child.birthDate);
        if (birth.getMonth() + 1 === todayMonth && birth.getDate() === todayDate) {
          birthdays.push({ name: child.name, isMyChild: true });
        }
      }
    });

    // ×‘×“×™×§×” ×©×œ ×™×œ×“×™× ××—×•×’×™× (×œ×“×•×’××” - ×™×•×‘×œ ×œ×•×™)
    if (todayMonth === 8 && todayDate === 13) {
      birthdays.push({ name: '×™×•×‘×œ ×œ×•×™', isMyChild: false });
    }

    return birthdays;
  };

  // Chatbot processing function
  const processChatMessage = async (message) => {
    setIsProcessing(true);
    
    const userMessage = {
      id: Date.now(),
      type: 'user',
      message: message,
      timestamp: new Date().toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' })
    };
    setChatMessages(prev => [...prev, userMessage]);

    setTimeout(() => {
      let botResponse = '';
      let scheduleChangeType = null;
      let requiresNewAvailability = false;

      if (message.includes('×—×•×œ×”') || message.includes('×œ× ×™×›×•×œ') || message.includes('×œ× ×™×›×•×œ×”') || message.includes('×—×™×¨×•×')) {
        botResponse = 'ğŸš¨ **×–×•×”×ª×” ×‘×§×©×ª ×—×™×¨×•×!**\n\n' +
          'ğŸ“ **×¤×¢×•×œ×” ××™×™×“×™×ª:** ×©×•×œ×— SMS ×œ×›×œ ×”××©×¤×—×•×ª ×‘×—×•×’\n' +
          'ğŸ’¬ ×ª×•×›×Ÿ ×”×”×•×“×¢×”: ' + message + '\n\n' +
          'âš¡ **×—×™×¤×•×© ×ª×—×œ×™×£ ××”×™×¨:**\n' +
          'â€¢ ×”×•×“×¢×” × ×©×œ×—×” ×œ×›×œ ×”×”×•×¨×™× ×”×–××™× ×™×\n' +
          'â€¢ ×‘×§×©×” ×“×—×•×¤×” ×œ××¦×™××ª ×ª×—×œ×™×£\n\n' +
          'ğŸ“‹ **××” ×§×•×¨×” ×¢×›×©×™×•:**\n' +
          '1. ×›×œ ×”××©×¤×—×•×ª ××§×‘×œ×•×ª ×”×ª×¨××” ×“×—×•×¤×”\n' +
          '2. ×”××©×¤×—×” ×”×¨××©×•× ×” ×©×ª×¢× ×” ×ª×”×™×” ×”×ª×—×œ×™×£\n' +
          '3. ×”×©×™×‘×•×¥ ×™×¢×•×“×›×Ÿ ××•×˜×•××˜×™×ª ×‘×¨×’×¢ ×©×™××¦× ×ª×—×œ×™×£\n' +
          '4. ×›×•×œ× ×™×§×‘×œ×• ×¢×“×›×•×Ÿ ×¢×œ ×”×ª×—×œ×™×£ ×”×—×“×©\n\n' +
          'â° **×–××Ÿ ×ª×’×•×‘×” ×¦×¤×•×™:** 5-15 ×“×§×•×ª';
        scheduleChangeType = { action: 'emergency_substitute', message: message, description: '×‘×§×©×ª ×ª×—×œ×™×£ ×—×™×¨×•×' };
        requiresNewAvailability = false;
      } else if (message.includes('×‘×™×˜×•×œ') || message.includes('×œ× ×™×ª×§×™×™×')) {
        botResponse = 'âœ… ×–×•×”×” ×‘×™×˜×•×œ ×—×•×’.\n\n' +
          'ğŸ“‹ **×©×œ×‘ ×”×‘×:** ×™×© ×œ××œ× ×–××™× ×•×ª ××—×“×©\n' +
          '× ×©×œ×—×” ×‘×§×©×” ×œ×›×œ ×”××©×¤×—×•×ª ×œ××œ× ×–××™× ×•×ª ×¢×‘×•×¨ ×”×©×‘×•×¢ ×”××¢×•×“×›×Ÿ.\n\n' +
          'â³ **×¡×˜×˜×•×¡ ××™×œ×•×™ ×–××™× ×•×ª:**\n' +
          'â€¢ ××©×¤×—×ª ×“×•×“: âœ… ××™×œ×\n' +
          'â€¢ ×©××¨ ×”××©×¤×—×•×ª: â³ ×××ª×™× ×•×ª\n\n' +
          '×”×©×™×‘×•×¥ ×”×—×“×© ×™×¤×•×¨×¡× ××•×˜×•××˜×™×ª ×‘×¨×’×¢ ×©×›×•×œ× ×™××œ××• ×–××™× ×•×ª.';
        scheduleChangeType = { action: 'cancel', description: '×‘×™×˜×•×œ ×—×•×’' };
        requiresNewAvailability = true;
      } else {
        botResponse = 'âœ… ×§×™×‘×œ×ª×™ ××ª ×”×”×•×“×¢×”. ×× ×–×• ×”×•×“×¢×” ××”××××Ÿ ×©×“×•×¨×©×ª ×¢×“×›×•×Ÿ ×”×©×™×‘×•×¥, ×× ×™ ×™×›×•×œ ×œ×¢×–×•×¨.\n\n' +
          '× ×•×©××™× ×©×× ×™ ×™×›×•×œ ×œ×˜×¤×œ ×‘×”×:\n' +
          'â€¢ ğŸš¨ **×—×™×¨×•×** - ×”×•×¨×”/×™×œ×“ ×—×•×œ×” (×˜×™×¤×•×œ ××™×™×“×™)\n' +
          'â€¢ âŒ ×‘×™×˜×•×œ×™ ×—×•×’×™×\n' +
          'â€¢ ğŸ• ×©×™× ×•×™×™ ×©×¢×•×ª\n' +
          'â€¢ ğŸ“ ×©×™× ×•×™×™ ××™×§×•×\n' +
          'â€¢ ğŸ”„ ×‘×§×©×•×ª ×”×—×œ×¤×” ×¨×’×™×œ×•×ª\n' +
          'â€¢ ğŸ“… ×œ×•×—×•×ª ×–×× ×™× ×—×“×©×™×\n\n' +
          '×¤×©×•×˜ ×”×“×‘×§ ××ª ×”×”×•×“×¢×” ××”×•×•××˜×¡××¤ ×•×”×™× ×ª×¢×•×“×›×Ÿ ××•×˜×•××˜×™×ª!';
      }

      const botMessage = {
        id: Date.now() + 1,
        type: 'bot',
        message: botResponse,
        timestamp: new Date().toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' }),
        scheduleUpdate: scheduleChangeType,
        requiresAvailability: requiresNewAvailability
      };
      
      setChatMessages(prev => [...prev, botMessage]);
      
      if (requiresNewAvailability && scheduleChangeType) {
        setPendingScheduleChange(scheduleChangeType);
        setAvailabilityStatus({
          '××©×¤×—×ª ×›×”×Ÿ': false,
          '××©×¤×—×ª ×œ×•×™': false, 
          '××©×¤×—×ª ××‘×¨×”×': false,
          '××©×¤×—×ª ×“×•×“': true,
          '××©×¤×—×ª ×©×œ×•×': false,
          '××©×¤×—×ª ×—×Ÿ': false
        });

        const newNotification = {
          id: Date.now() + 2,
          text: '× ×“×¨×© ××™×œ×•×™ ×–××™× ×•×ª ××—×“×©: ' + scheduleChangeType.description,
          type: 'warning',
          time: new Date().toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' })
        };
        setNotifications(prev => [newNotification, ...prev]);
      }
      
      setIsProcessing(false);
    }, 2000);
  };

  const handleChatSubmit = (e) => {
    e.preventDefault();
    if (chatInput.trim()) {
      processChatMessage(chatInput.trim());
      setChatInput('');
    }
  };

  // Family Home Page Component
  const FamilyHomePage = () => {
    const todaysBirthdays = getTodaysBirthdays();
    
    return React.createElement('div', { className: 'space-y-6', dir: 'rtl' },
      // Header
      React.createElement('div', { className: 'bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl p-6 text-white' },
        React.createElement('h1', { className: 'text-2xl font-bold mb-2' }, '×©×œ×•×, ' + familyData.familyName + '!'),
        React.createElement('p', { className: 'text-blue-100' }, '× ×™×”×•×œ ×—×•×’×™× ×•×§×•××•×¨×“×™× ×¦×™×”')
      ),

      // Birthday Messages
      todaysBirthdays.length > 0 && React.createElement('div', { className: 'space-y-2' },
        todaysBirthdays.map((birthday, index) =>
          React.createElement('div', { 
            key: index, 
            className: 'bg-gradient-to-r from-pink-500 to-yellow-500 rounded-xl p-4 text-white' 
          },
            React.createElement('div', { className: 'flex items-center' },
              React.createElement('span', { className: 'text-2xl ml-3' }, 'ğŸ‰'),
              React.createElement('div', null,
                React.createElement('h3', { className: 'font-bold text-lg' }, '×™×•× ×”×•×œ×“×ª ×©××—!'),
                React.createElement('p', { className: 'text-pink-100' }, 
                  birthday.isMyChild ? birthday.name + ' ×—×•×’×’/×ª ×”×™×•×' : birthday.name + ' ××”×—×•×’ ×—×•×’×’/×ª ×”×™×•×'
                )
              )
            )
          )
        )
      ),

      // Quick Stats
      React.createElement('div', { className: 'grid grid-cols-3 gap-4' },
        React.createElement('div', { className: 'bg-green-50 rounded-lg p-4 text-center border border-green-200' },
          React.createElement('div', { className: 'text-2xl font-bold text-green-600' },
            familyData.children.reduce((total, child) => total + child.classes.length, 0)
          ),
          React.createElement('div', { className: 'text-sm text-green-700' }, '×—×•×’×™× ×¤×¢×™×œ×™×')
        ),
        React.createElement('div', { className: 'bg-blue-50 rounded-lg p-4 text-center border border-blue-200' },
          React.createElement('div', { className: 'text-2xl font-bold text-blue-600' }, familyData.children.length),
          React.createElement('div', { className: 'text-sm text-blue-700' }, '×™×œ×“×™×')
        ),
        React.createElement('div', { className: 'bg-purple-50 rounded-lg p-4 text-center border border-purple-200' },
          React.createElement('div', { className: 'text-2xl font-bold text-purple-600' },
            familyData.children.reduce((total, child) => 
              total + child.classes.reduce((classTotal, cls) => classTotal + cls.myTasks.length, 0), 0
            )
          ),
          React.createElement('div', { className: 'text-sm text-purple-700' }, '××©×™××•×ª ×”×©×‘×•×¢')
        )
      ),

      // Notifications
      notifications.length > 0 && React.createElement('div', { className: 'bg-white rounded-lg border border-gray-200 p-4' },
        React.createElement('h3', { className: 'font-semibold mb-3 flex items-center' },
          React.createElement(Icon, { name: 'fas fa-bell', className: 'w-5 h-5 ml-2 text-orange-500' }),
          '×”×ª×¨××•×ª'
        ),
        notifications.map(notif =>
          React.createElement('div', { 
            key: notif.id, 
            className: 'p-3 rounded-lg mb-2 last:mb-0 ' + (
              notif.type === 'warning' ? 'bg-orange-50 border border-orange-200' : 'bg-blue-50 border border-blue-200'
            )
          },
            React.createElement('div', { className: 'flex justify-between items-start' },
              React.createElement('span', { className: 'text-sm' }, notif.text),
              React.createElement('span', { className: 'text-xs text-gray-500' }, notif.time)
            )
          )
        )
      ),

      // Children and Classes
      React.createElement('div', { className: 'bg-white rounded-lg border border-gray-200 p-4' },
        React.createElement('h3', { className: 'font-semibold mb-4 flex items-center' },
          React.createElement(Icon, { name: 'fas fa-users', className: 'w-5 h-5 ml-2 text-blue-500' }),
          '×”×™×œ×“×™× ×•×”×—×•×’×™× ×©×œ×”×'
        ),
        
        familyData.children.map(child => {
          const age = calculateAge(child.birthDate);
          return React.createElement('div', { key: child.id, className: 'mb-6 last:mb-0' },
            React.createElement('div', { className: 'flex items-center justify-between mb-3' },
              React.createElement('h4', { className: 'font-medium text-lg' }, child.name),
              React.createElement('span', { className: 'text-sm text-gray-600' },
                age ? '×’×™×œ ' + age : '×œ×œ× ×’×™×œ'
              )
            ),
            
            React.createElement('div', { className: 'grid gap-3' },
              child.classes.map(classItem =>
                React.createElement('div', { 
                  key: classItem.id,
                  onClick: () => {
                    setSelectedChild(child);
                    setSelectedClass(classItem);
                    setCurrentView('class-home');
                  },
                  className: 'bg-gray-50 border border-gray-200 rounded-lg p-4 cursor-pointer hover:bg-gray-100 transition-colors'
                },
                  React.createElement('div', { className: 'flex justify-between items-start' },
                    React.createElement('div', { className: 'flex-1' },
                      React.createElement('div', { className: 'font-medium text-blue-600' }, classItem.name),
                      React.createElement('div', { className: 'text-sm text-gray-600 mt-1' }, classItem.location),
                      React.createElement('div', { className: 'text-sm text-gray-500' }, classItem.schedule),
                      classItem.myTasks.length > 0 && React.createElement('div', { className: 'text-sm text-green-600 mt-1' },
                        classItem.myTasks.length + ' ××©×™××•×ª ×”×©×‘×•×¢'
                      )
                    ),
                    React.createElement(Icon, { name: 'fas fa-arrow-left', className: 'w-5 h-5 text-gray-400' })
                  )
                )
              ),
              
              React.createElement('button', { 
                onClick: () => setCurrentView('class-add-edit'),
                className: 'border border-dashed border-gray-300 rounded-lg p-4 text-gray-600 hover:bg-gray-50 transition-colors'
              },
                React.createElement(Icon, { name: 'fas fa-plus', className: 'w-5 h-5 mx-auto mb-1' }),
                React.createElement('div', { className: 'text-sm' }, '×”×•×¡×£ ×—×•×’ ×œ' + child.name)
              )
            )
          );
        }),
        
        React.createElement('button', { 
          onClick: () => setCurrentView('add-child'),
          className: 'w-full border border-dashed border-gray-300 rounded-lg p-4 text-gray-600 hover:bg-gray-50 transition-colors mt-4'
        },
          React.createElement(Icon, { name: 'fas fa-plus', className: 'w-5 h-5 mx-auto mb-1' }),
          React.createElement('div', { className: 'text-sm' }, '×”×•×¡×£ ×™×œ×“ ×œ××©×¤×—×”')
        )
      ),

      // Quick Access to Waiting Room
      React.createElement('div', { className: 'bg-gradient-to-r from-green-500 to-blue-500 rounded-xl p-6 text-white' },
        React.createElement('div', { className: 'flex items-center mb-3' },
          React.createElement('span', { className: 'text-2xl ml-3' }, 'ğŸ”'),
          React.createElement('div', null,
            React.createElement('h3', { className: 'font-bold text-lg' }, '××—×¤×© ×§×‘×•×¦×ª ×”×¡×¢×•×ª ×—×“×©×”?'),
            React.createElement('p', { className: 'text-green-100 text-sm' }, '××¦× ×”×•×¨×™× ×œ×—×•×’×™× ×—×“×©×™× ××• ×¦×•×¨ ×§×‘×•×¦×” ××©×œ×š')
          )
        ),
        React.createElement('button', { 
          onClick: () => setCurrentView('waiting-room'),
          className: 'bg-white bg-opacity-20 backdrop-blur-sm text-white border border-white border-opacity-30 rounded-lg px-6 py-3 font-medium hover:bg-opacity-30 transition-all'
        },
          'ğŸš€ ×›× ×¡ ×œ×—×“×¨ ×”××ª× ×”'
        )
      ),

      // Admin Access (hidden button for admin)
      React.createElement('div', { className: 'text-center' },
        React.createElement('button', {
          onClick: () => setShowAdminLogin(true),
          className: 'text-xs text-gray-400 hover:text-gray-600 transition-colors',
          title: '×›× ×™×¡×” ×œ×× ×”×œ ××¢×¨×›×ª'
        }, '× ×™×”×•×œ ××¢×¨×›×ª')
      )
    );
  };

  // Class Home Page Component
  const ClassHomePage = () => {
    if (!selectedClass || !selectedChild) return null;

    return React.createElement('div', { className: 'space-y-6', dir: 'rtl' },
      // Header with back button
      React.createElement('div', { className: 'flex items-center mb-4' },
        React.createElement('button', { 
          onClick: () => setCurrentView('family-home'),
          className: 'ml-3 p-2 hover:bg-gray-100 rounded-lg'
        },
          React.createElement(Icon, { name: 'fas fa-home' })
        ),
        React.createElement('div', { className: 'flex-1' },
          React.createElement('h2', { className: 'text-xl font-bold' }, selectedClass.name),
          React.createElement('p', { className: 'text-gray-600' }, selectedChild.name + ' â€¢ ' + selectedClass.location)
        )
      ),

      // Class Info
      React.createElement('div', { className: 'bg-gradient-to-r from-green-600 to-blue-600 rounded-xl p-6 text-white' },
        React.createElement('h3', { className: 'text-lg font-bold mb-2' }, selectedClass.name),
        React.createElement('div', { className: 'space-y-1 text-green-100' },
          React.createElement('div', { className: 'flex items-center' },
            React.createElement(Icon, { name: 'fas fa-map-marker-alt', className: 'w-4 h-4 ml-2' }),
            React.createElement('span', null, selectedClass.address)
          ),
          React.createElement('div', { className: 'flex items-center' },
            React.createElement(Icon, { name: 'fas fa-clock', className: 'w-4 h-4 ml-2' }),
            React.createElement('span', null, selectedClass.schedule)
          ),
          React.createElement('div', { className: 'flex items-center' },
            React.createElement(Icon, { name: 'fas fa-phone', className: 'w-4 h-4 ml-2' }),
            React.createElement('span', null, selectedClass.coach)
          )
        )
      ),

      // Quick Actions
      React.createElement('div', { className: 'grid grid-cols-2 gap-4' },
        React.createElement('button', { 
          onClick: () => setCurrentView('availability'),
          className: 'bg-blue-600 text-white rounded-lg p-4 hover:bg-blue-700 transition-colors'
        },
          React.createElement(Icon, { name: 'fas fa-clock', className: 'w-6 h-6 mx-auto mb-2' }),
          React.createElement('span', { className: 'block text-sm font-medium' }, '××œ× ×–××™× ×•×ª')
        ),
        React.createElement('button', { 
          onClick: () => setCurrentView('class-families'),
          className: 'bg-purple-600 text-white rounded-lg p-4 hover:bg-purple-700 transition-colors'
        },
          React.createElement(Icon, { name: 'fas fa-users', className: 'w-6 h-6 mx-auto mb-2' }),
          React.createElement('span', { className: 'block text-sm font-medium' }, '××©×¤×—×•×ª ×‘×—×•×’')
        )
      )
    );
  };

  // ChatBot Page Component
  const ChatBotPage = () => (
    React.createElement('div', { className: 'space-y-6', dir: 'rtl' },
      React.createElement('h2', { className: 'text-xl font-bold' }, '×¢×•×–×¨ ×”×—×•×’×™×'),
      
      React.createElement('div', { className: 'bg-blue-50 border border-blue-200 rounded-lg p-4' },
        React.createElement('div', { className: 'flex items-center mb-2' },
          React.createElement('div', { className: 'w-3 h-3 bg-green-400 rounded-full ml-2' }),
          React.createElement('span', { className: 'font-medium text-blue-800' }, '×¢×•×–×¨ ×¤×¢×™×œ')
        ),
        React.createElement('p', { className: 'text-sm text-blue-700' },
          '×©×œ×— ×”×•×“×¢×•×ª ××”××××Ÿ ××• ×›×ª×•×‘ ×©×™× ×•×™×™× ×™×©×™×¨×•×ª. ×”×¢×•×–×¨ ×™×¢×“×›×Ÿ ××ª ×”×©×™×‘×•×¥ ×”×©×‘×•×¢×™ ××•×˜×•××˜×™×ª!'
        )
      ),

      // Chat Messages
      React.createElement('div', { className: 'bg-white rounded-lg border border-gray-200' },
        React.createElement('div', { className: 'h-80 overflow-y-auto p-4 space-y-4' },
          chatMessages.map(msg =>
            React.createElement('div', { 
              key: msg.id, 
              className: 'flex ' + (msg.type === 'user' ? 'justify-start' : 'justify-end')
            },
              React.createElement('div', { 
                className: 'max-w-sm p-3 rounded-lg ' + (
                  msg.type === 'user' 
                    ? 'bg-gray-100 text-gray-800' 
                    : 'bg-blue-100 text-blue-800'
                )
              },
                React.createElement('div', { className: 'whitespace-pre-wrap text-sm' }, msg.message),
                React.createElement('div', { className: 'text-xs text-gray-500 mt-2' }, msg.timestamp),
                msg.scheduleUpdate && React.createElement('div', { 
                  className: 'mt-2 p-2 bg-green-50 border border-green-200 rounded text-xs text-green-700'
                },
                  'âœ… ×”×©×™×‘×•×¥ ×¢×•×“×›×Ÿ ×‘×”×ª××'
                )
              )
            )
          ),
          
          isProcessing && React.createElement('div', { className: 'flex justify-end' },
            React.createElement('div', { className: 'bg-blue-100 text-blue-800 p-3 rounded-lg' },
              React.createElement('div', { className: 'flex items-center text-sm' },
                React.createElement('div', { className: 'animate-spin w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full ml-2' }),
                '××¢×‘×“ ×”×•×“×¢×”...'
              )
            )
          )
        ),

        // Chat Input
        React.createElement('div', { className: 'border-t border-gray-200 p-4' },
          React.createElement('form', { onSubmit: handleChatSubmit, className: 'space-y-3' },
            React.createElement('div', { className: 'flex space-x-2 space-x-reverse' },
              React.createElement('input', {
                type: 'text',
                value: chatInput,
                onChange: (e) => setChatInput(e.target.value),
                placeholder: '×”×“×‘×§ ×”×•×“×¢×” ××•×•××˜×¡××¤ ××• ×›×ª×•×‘ ×©×™× ×•×™...',
                className: 'flex-1 p-3 border border-gray-300 rounded-lg text-right',
                disabled: isProcessing
              }),
              React.createElement('button', {
                type: 'submit',
                disabled: isProcessing || !chatInput.trim(),
                className: 'bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 font-medium'
              },
                '×©×œ×—'
              )
            )
          ),
          
          // Quick Actions
          React.createElement('div', { className: 'mt-3 flex flex-wrap gap-2' },
            React.createElement('button', {
              onClick: () => setChatInput('×”×™×œ×“ ×©×œ×™ ×—×•×œ×” ×œ× ×™×›×•×œ ×œ×”×’×™×¢ ×œ×—×•×’ ×”×™×•×'),
              className: 'px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm hover:bg-red-200'
            },
              'ğŸš¨ ×—×™×¨×•× - ×™×œ×“ ×—×•×œ×”'
            ),
            React.createElement('button', {
              onClick: () => setChatInput('×× ×™ ×—×•×œ×” ×œ× ×™×›×•×œ ×œ×”×¡×™×¢ ×”×™×•×'),
              className: 'px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm hover:bg-red-200'
            },
              'ğŸš¨ ×—×™×¨×•× - ×”×•×¨×” ×—×•×œ×”'
            ),
            React.createElement('button', {
              onClick: () => setChatInput('×‘×™×˜×•×œ ×—×•×’ ×‘×™×•× ×¨××©×•×Ÿ'),
              className: 'px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200'
            },
              '×‘×™×˜×•×œ ×—×•×’'
            )
          )
        )
      ),

      // Usage Tips
      React.createElement('div', { className: 'bg-green-50 border border-green-200 rounded-lg p-4' },
        React.createElement('h3', { className: 'font-medium text-green-800 mb-2' }, 'ğŸ’¡ ×˜×™×¤×™× ×œ×©×™××•×©:'),
        React.createElement('ul', { className: 'text-sm text-green-700 space-y-1' },
          React.createElement('li', null, 'â€¢ ×”×¢×ª×§ ×•×”×“×‘×§ ×”×•×“×¢×•×ª ×™×©×™×¨×•×ª ××§×‘×•×¦×ª ×”×•×•××˜×¡××¤'),
          React.createElement('li', null, 'â€¢ ×›×ª×•×‘ ×©×™× ×•×™×™× ×‘×¢×‘×¨×™×ª ×¤×©×•×˜×”'),
          React.createElement('li', null, 'â€¢ ×”×¢×•×–×¨ ×™×–×”×” ××•×˜×•××˜×™×ª ×‘×™×˜×•×œ×™×, ×©×™× ×•×™×™ ×©×¢×•×ª ×•×‘×§×©×•×ª ×”×—×œ×¤×”'),
          React.createElement('li', null, 'â€¢ ×›×œ ×¢×“×›×•×Ÿ ×™×©×œ×— ×”×ª×¨××” ×œ××©×¤×—×•×ª ×”×¨×œ×•×•× ×˜×™×•×ª')
        )
      )
    )
  );

  // Navigation Component
  const Navigation = () => {
    const getNavItems = () => {
      if (isAdminMode) {
        return [
          { id: 'admin-dashboard', icon: 'fas fa-chart-bar', label: '×œ×•×— ××—×•×•× ×™×' },
          { id: 'admin-families', icon: 'fas fa-users', label: '××©×¤×—×•×ª' },
          { id: 'admin-classes', icon: 'fas fa-calendar', label: '×—×•×’×™×' },
          { id: 'admin-reports', icon: 'fas fa-clipboard-list', label: '×“×•×—×•×ª' }
        ];
      } else if (currentView === 'family-home' || currentView === 'chatbot' || currentView === 'settings' || currentView === 'user-guide' || currentView === 'waiting-room' || currentView === 'create-group') {
        return [
          { id: 'family-home', icon: 'fas fa-home', label: '×‘×™×ª' },
          { id: 'waiting-room', icon: 'fas fa-users', label: '×—×“×¨ ×”××ª× ×”' },
          { id: 'chatbot', icon: 'fas fa-bell', label: '×¢×•×–×¨ ×”×—×•×’×™×' },
          { id: 'settings', icon: 'fas fa-cog', label: '×”×’×“×¨×•×ª' }
        ];
      } else {
        return [
          { id: 'family-home', icon: 'fas fa-home', label: '×‘×™×ª ×”××©×¤×—×”' },
          { id: 'class-home', icon: 'fas fa-calendar', label: '×”×—×•×’' },
          { id: 'availability', icon: 'fas fa-clock', label: '×–××™× ×•×ª' },
          { id: 'class-families', icon: 'fas fa-users', label: '××©×¤×—×•×ª' }
        ];
      }
    };

    return React.createElement('div', { 
      className: 'fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2', 
      dir: 'rtl' 
    },
      React.createElement('div', { className: 'flex justify-around' },
        getNavItems().map(item =>
          React.createElement('button', {
            key: item.id,
            onClick: () => setCurrentView(item.id),
            className: 'flex flex-col items-center py-2 px-3 rounded-lg transition-colors ' + (
              currentView === item.id 
                ? 'text-blue-600 bg-blue-50' 
                : 'text-gray-600 hover:text-gray-800 hover:bg-gray-50'
            )
          },
            React.createElement(Icon, { name: item.icon, className: 'w-5 h-5 mb-1' }),
            React.createElement('span', { className: 'text-xs' }, item.label)
          )
        )
      )
    );
  };

  // Settings Page Component
  const SettingsPage = () => (
    React.createElement('div', { className: 'space-y-6', dir: 'rtl' },
      React.createElement('h2', { className: 'text-xl font-bold' }, '×”×’×“×¨×•×ª'),
      
      // Profile Section
      React.createElement('div', { className: 'bg-white rounded-lg border border-gray-200 p-4' },
        React.createElement('h3', { className: 'font-medium mb-4 flex items-center' },
          React.createElement(Icon, { name: 'fas fa-users', className: 'w-5 h-5 ml-2 text-blue-500' }),
          '×¤×¨×˜×™× ××™×©×™×™×'
        ),
        React.createElement('div', { className: 'space-y-4' },
          // Family Name
          React.createElement('div', null,
            React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' },
              '×©× ××©×¤×—×” ',
              React.createElement('span', { className: 'text-red-500' }, '*')
            ),
            React.createElement('input', { 
              type: 'text', 
              value: familyData.familyName, 
              className: 'w-full p-2 border border-gray-300 rounded-lg text-right',
              required: true
            })
          ),

          // Parent 1
          React.createElement('div', { className: 'bg-blue-50 rounded-lg p-3 border border-blue-200' },
            React.createElement('h4', { className: 'font-medium text-blue-800 mb-3' }, '×”×•×¨×” 1'),
            React.createElement('div', { className: 'space-y-3' },
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' },
                  '×©× ×¤×¨×˜×™ ',
                  React.createElement('span', { className: 'text-red-500' }, '*')
                ),
                React.createElement('input', { 
                  type: 'text', 
                  placeholder: '×™×•×¡×™',
                  defaultValue: familyData.parents.parent1.name,
                  className: 'w-full p-2 border border-gray-300 rounded-lg text-right',
                  required: true
                })
              ),
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' },
                  '×˜×œ×¤×•×Ÿ ',
                  React.createElement('span', { className: 'text-red-500' }, '*')
                ),
                React.createElement('input', { 
                  type: 'tel', 
                  placeholder: '050-123-4567',
                  defaultValue: familyData.parents.parent1.phone,
                  className: 'w-full p-2 border border-gray-300 rounded-lg text-right',
                  required: true
                })
              ),
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' },
                  '××™××™×™×œ (×¨×©×•×ª)'
                ),
                React.createElement('input', { 
                  type: 'email', 
                  placeholder: 'yossi@gmail.com',
                  defaultValue: familyData.parents.parent1.email,
                  className: 'w-full p-2 border border-gray-300 rounded-lg text-right'
                })
              )
            )
          ),

          // Parent 2
          React.createElement('div', { className: 'bg-pink-50 rounded-lg p-3 border border-pink-200' },
            React.createElement('h4', { className: 'font-medium text-pink-800 mb-3' }, '×”×•×¨×” 2'),
            React.createElement('div', { className: 'space-y-3' },
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' },
                  '×©× ×¤×¨×˜×™ ',
